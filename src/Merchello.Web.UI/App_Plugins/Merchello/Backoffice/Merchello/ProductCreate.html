<form novalidate name="productVariantForm" 
      data-ng-controller="Merchello.Editors.Product.CreateController" 
      data-ng-show="loaded" 
      data-ng-submit="save()">
    <umb-panel val-show-validation>

	    <umb-header>

		    <div class="span4">
			    <umb-content-name ng-model="productVariant.name"
			                      localize="placeholder" placeholder="@merchelloPlaceholders_enterProduct">
			    </umb-content-name>
		    </div>

		    <div class="col-xs-8 span8">
			    <div class="btn-toolbar pull-right umb-btn-toolbar">
				    <div class="btn-group">
					    <a data-ng-disabled="productVariantForm.$invalid" data-ng-click="save(productVariantForm)" class="btn btn-success"><localize key="buttons_save" /></a>
				    </div>
			    </div>
		    </div>

	    </umb-header>

	    <merchello-panel>
		    <div class="tab-content row-fluid">
			    <div class="merchello-pane">
                    
				    <!-- Property classes from Umbraco styles -->
				    <div class="control-group umb-control-group">
					    <label class="merchello-control-label">
						    <localize key="merchelloVariant_variantInfo"/>
						    <small><localize key="merchelloVariant_configVariant" /></small>
					    </label>

				        <div class="merchello-controls">

						    <div>
							    <h3><localize key="merchelloVariant_createProduct"/></h3>
							    <p><localize key="merchelloVariant_createProductSub"/></p>
						    </div>

                            <!-- Form for checkboxes that manage below sections, key fields like SKU, Price, etc -->
					        <product-variant-main-properties product="product" product-variant="productVariant" creating-variant="creatingVariant" editing-variant="editingVariant"></product-variant-main-properties>                            

					    </div>
				    </div>

                    <!-- Digital Downloads Picker -->
			        <merchello-slide-open-panel is-open="productVariant.hasDigitalDownload">
			            <product-digital-download-section product="product" product-variant="productVariant" ></product-digital-download-section>
			        </merchello-slide-open-panel>
              
                    <!-- Product Options and Variants -->
			        <merchello-slide-open-panel is-open="product.hasOptions">
					    <label class="merchello-control-label">
						    <localize key="merchelloGeneral_multipleOptions"/>
						    <small><localize key="merchelloVariant_addOptions"/></small>
					    </label>

					    <div class="merchello-controls row-fluid">

						    <div class="well col-xs-10 span10">
							    <table class="table product-options">
								    <tr>
									    <th>
										    <localize key="merchelloVariant_optionName"/>
										    <small><localize key="merchelloVariant_optionNameExamples"/></small>
									    </th>
									    <th>
											<localize key="merchelloVariant_optionValues" />
										    <small><localize key="merchelloVariant_optionValueExamples"/></small>
									    </th>
								    </tr>
								    <tr data-ng-repeat="option in product.productOptions | orderBy:'sortOrder'">
									    <td>
										    <a data-ng-click="removeOption(option)" class="btn btn-small btn-warning"><i class="icon-trash"></i></a>                                        
										    <input class="form-control col-xs-8 span8" type="text" localize="placeholder" placeholder="@merchelloPlaceholders_addStyle" data-ng-model="option.name" />
									    </td>
									    <td>
										    <tag-manager option="option"></tag-manager>
									    </td>
								    </tr>
							    </table>

							    <div>
								    <a data-ng-click="addOption()" class="btn add"><localize key="merchelloVariant_addOption"/></a>
								    <a data-ng-click="updateVariants(productVariantForm)" class="btn btn-primary add"><localize key="general_update"/></a>
							    </div>
						    </div>

						    <div class="col-xs-10 span10">
							    <table class="table">
								    <tr>
									    <th>
										    <localize key="merchelloVariant_variant"/>
									    </th>
									    <th>
										    <localize key="merchelloGeneral_price"/>
									    </th>
									    <!--<th>
										        SKU <small>(optional)</small>
									        </th>-->
									    <th>
										    <localize key="merchelloVariant_barcode"/> <small><localize key="merchelloGeneral_optional"/></small>
									    </th>
									    <th>
										    <localize key="merchelloInventory_inventory"/>
									    </th>
								    </tr>
								    <tr data-ng-repeat="variant in product.productVariants">
									    <td>
										    <input type="checkbox" data-ng-model="variant.selected"/>
										    <span data-ng-repeat="attribute in variant.attributes">
											    <span>{{attribute.name}}</span>
											    <span data-ng-show="!$last"> / </span>
										    </span>                                                    
									    </td>
									    <td>
										    <input class="form-control input-mini" data-ng-model="variant.price" />
									    </td>
									    <!--<td>
										        <input class="form-control input-mini" data-ng-model="variant.sku" />
									        </td>-->
									    <td>
										    <input class="form-control input-mini" data-ng-model="variant.barcode" />
									    </td>
									    <td>
										    <input type="checkbox" data-ng-model="variant.trackInventory" />
										    <input class="form-control input-mini" data-ng-show="variant.trackInventory" data-ng-model="variant.totalInventoryCount" data-ng-change="variant.globalInventoryChanged(variant.totalInventoryCount)" />
									    </td>
								    </tr>
							    </table>
						    </div>

						    <div class="row-fluid">

							    <div class="warning col-xs-10 span10">
								    <i class="icon-alert large"></i>
								    <localize key="merchelloVariant_inventoryWarning"/>
							    </div>

							    <div class="form-group col-xs-6 span6">
								    <label for="base-inventory"><localize key="merchelloInventory_base"/>
									    <small><localize key="merchelloVariant_startingInventoryWarning" /></small>
								    </label>
								    <input id="base-inventory" type="text" name="base-inventory" data-ng-model="allVariantInventories" class="form-control col-xs-8 span8"  />
								    <a data-ng-click="applyAllVariantInventories(allVariantInventories)" class="btn btn-primary"><localize key="merchelloGeneral_apply"/></a>
							    </div>

						    </div>

					    </div>
			        </merchello-slide-open-panel>

                    <!-- Inventory for a single product without options -->
			        <merchello-slide-open-panel is-open="(productVariant.trackInventory && !productVariant.hasOptions)">
			            <product-inventory-section product="product" product-variant="productVariant" default-warehouse="defaultWarehouse" warehouses="warehouses" ></product-inventory-section>
			        </merchello-slide-open-panel>

                    <!-- Shipping settings for a product. -->
			        <merchello-slide-open-panel is-open="productVariant.shippable">
			            <product-shipping-section product="product" product-variant="productVariant" ></product-shipping-section>
			        </merchello-slide-open-panel>

                    <merchello-debug-section data-props-to-debug="product,productVariant"></merchello-debug-section>


			    </div>
			    <!-- /merchello-pane -->

		    </div>
	    </merchello-panel>


    </umb-panel>
</form>